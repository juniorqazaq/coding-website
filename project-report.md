# Отчет по архитектуре проекта Tamasha

## 1. СТРУКТУРА ПРОЕКТА (PROJECT STRUCTURE)
Ниже представлен обзор файлов и папок проекта:

*   **`/components/`** — Переиспользуемые визуальные и логические компоненты интерфейса:
    *   `AIAssistant.tsx` — AI-ассистент в интерфейсе свернутого виджета чата.
    *   `AuthVisuals.tsx` — Визуальная часть страниц входа и регистрации (кодинг-анимация).
    *   `CodingPromo.tsx` — Секция, промотирующая интерактивную среду кодинга на главной.
    *   `CTA.tsx` — Компонент Call-To-Action для конверсии (побуждение к регистрации).
    *   `FAQ.tsx` — Блок "Часто задаваемые вопросы" (аккордеон).
    *   `Features.tsx` — Раздел списка преимуществ/фичей платформы.
    *   `Footer.tsx` — Подвал (футер) сайта.
    *   `Hero.tsx` — Главный экран лендинга.
    *   `Layout.tsx` — Обертка для авторизованных страниц (боковое меню + контент).
    *   `LearningMap.tsx` — Визуальный компонент "карты обучения" (путь или дерево навыков).
    *   `Logo.tsx` — Компонент логотипа платформы (с иконкой).
    *   `MockEditor.tsx` — Встроенный редактор кода с заглушкой (симуляция выполнения JS).
    *   `Navbar.tsx` — Верхняя навигационная панель.
    *   `PopularCourses.tsx` — Блок с популярными курсами (карусель/сетка).
    *   `PublicLayout.tsx` — Простая обертка для публичных страниц (Navbar + Footer).
    *   `Testimonials.tsx` — Отзывы учеников.
    *   `ThemeToggle.tsx` — Переключатель светлой и темной темы.

*   **`/pages/`** — Файлы-страницы приложения:
    *   `CodingArena.tsx` — Страница арены, обзор задач, рейтинг.
    *   `CodingGame.tsx` — Интерфейс решения задачи (редактор, описание задачи, панель AI).
    *   `Courses.tsx` — Общий каталог всех курсов платформы.
    *   `Dashboard.tsx` — Главный дашборд авторизованного ученика со статистикой.
    *   `Home.tsx` — Индексная страница лендинга.
    *   `LessonViewer.tsx` — Режим просмотра конкретного урока (чтение или практика).
    *   `Login.tsx` / `Register.tsx` — Страницы аутентификации.
    *   `MyCourses.tsx` — Дашборд курсов, на которые записан ученик.
    *   `Pricing.tsx` — Информационная страница со стоимостью подписки.
    *   `ProblemList.tsx` — Список задач для конкретной темы и сложности.
    *   `Profile.tsx` — Страница профиля ученика (аватар, био, достижения).
    *   `PythonCourse.tsx` — Обзор и программа курса Python.
    *   `PythonLesson.tsx` — Еще одна спецификация/версия просмотрщика урока для курса Python.
    *   `Quiz.tsx` — Геймифицированный тест-викторина после уроков.
    *   `Settings.tsx` — Настройки пользователя (тема, уведомления).
    *   `StudyWorkspace.tsx` — Фокус-кабинет (lo-fi музыка, таймер, фоновые картинки).
    *   `TopicDifficulty.tsx` — Страница выбора уровня сложности карточек кодинг-арены.

*   **`/data/`** — Замоканные данные:
    *   `coding-data.ts` — Доступные темы и задачи по программированию для арены.
    *   `python-course-data.ts` — Детальная структура (силлабус) курса Python.

*   **`App.tsx`** — Конфигурация роутинга React Router.
*   **`types.ts`** — TypeScript-интерфейсы (`User`, `Course`, `Lesson`, `Achievement`) и дополнительные моки.
*   **`tailwind.config.js` / `index.css`** — Конфигурация стилей, глобальные переменные, цвета (в т.ч. темная / светлая тема).

---

## 2. СТРАНИЦЫ И МАРШРУТИЗАЦИЯ (PAGES & ROUTING)
Используется `react-router-dom` (в режиме `HashRouter`).

**Публичные маршруты (Public)** — Обернуты в `<PublicLayout>`:
*   `/` -> `Home`
*   `/courses` -> `Courses`
*   `/pricing` -> `Pricing`

**Маршруты без обертки (Автономные)**:
*   `/login` -> `Login`
*   `/register` -> `Register`
*   `/study` -> `StudyWorkspace` (Полноэкранный фокус-режим)
*   `/coding/problem/:id` -> `CodingGame`
*   `/course/python` -> `PythonCourse`
*   `/course/python/module/:moduleId/lesson/:lessonId` -> `PythonLesson` 
*   `/course/:courseId/lesson/:lessonId` -> `LessonViewer`
*   `/course/:courseId` -> Редирект на `/courses` (заглушка)

**Защищенные / Персональные маршруты (Protected)** — Обернуты в `<Layout>` (с боковым меню), сейчас без реальной защиты authGuard:
*   `/dashboard` -> `Dashboard`
*   `/my-courses` -> `MyCourses`
*   `/profile` -> `Profile`
*   `/settings` -> `Settings`
*   `/coding` -> `CodingArena`
*   `/coding/topic/:topicId` -> `TopicDifficulty`
*   `/coding/topic/:topicId/:difficulty` -> `ProblemList`
*   `/quiz/:courseId/:lessonId` -> `Quiz`

---

## 3. КАРТА КОМПОНЕНТОВ (COMPONENTS MAP - Основные)
*   **`Layout`**:
    *   *Рендерит*: Боковое навигационное меню (Sidebar) и верхний бар (мобильный).
    *   *Состояние*: `isSidebarOpen` (моб. меню), `isCollapsed` (десктоп свернутое).
    *   *Использует*: `Logo`, `ThemeToggle`, `react-router-dom`.
*   **`LearningMap`**:
    *   *Рендерит*: Вертикальное дерево пути в стиле геймификации.
    *   *Пропсы*: `completedLessons` (массив ID завершенных уроков).
    *   *Источники*: Использует `pythonCourseData` из `/data`.
*   **`MockEditor`**:
    *   *Рендерит*: Окно написания кода, подсветку синтаксиса и фальшивый консольный вывод.
    *   *Пропсы*: `initialCode`.
    *   *Состояние*: `code` (строка), `output` (строка), `isRunning` (bool), `status` ('idle' | 'success' | 'error').
*   **`AuthVisuals`**:
    *   *Рендерит*: Красивую графическую анимацию для страниц `Login/Register` на стороне экрана.

---

## 4. УПРАВЛЕНИЕ СОСТОЯНИЕМ (STATE MANAGEMENT)
*   В текущий момент используется исклоючительно **локальный стейт** (`useState`, `useEffect`) внутри компонентов.
*   **Как это сейчас работает**:
    *   Прогресс, опыт (XP) или серия (streak) объявлены жестко внутри компонентов (مثال: `const [xp] = useState(12450)` в `Dashboard.tsx`, `CodingArena.tsx`, `StudyWorkspace.tsx`).
    *   Хранение завершенных уроков (completedLessons) также работает локально (`useState` + `Set`) или сбрасывается.
*   **Болевые точки (Pain Points)**:
    *   Высокое дублирование стейта пользователя (XP / Level / Streak) в каждом меню и компоненте отдельно. Изменение XP на экране `CodingGame` не отобразится на `Dashboard` или в `Layout`.
    *   Отсутствие глобального хранилища (Context / Zustand), что вызывает проблемы (Props Drilling) при необходимости передавать данные вниз или вверх по дереву.

---

## 5. СЛОЙ ДАННЫХ (DATA LAYER)
Все данные пока жестко закодированы и импортируются из директории `data/` файлов и `types.ts`:
*   `types.ts`: Экспортирует заглушку `MOCK_USER` и массив `COURSES`.
*   `coding-data.ts`: Экспортирует `CODING_TOPICS` и `MOCK_PROBLEMS` для арены.
*   `python-course-data.ts`: Экспортирует глубокую JSON-структуру с модулями, уроками, markdown-текстом.
*   Функции симуляции задержки по сети (например, `setTimeout` в `Register.tsx` и `Login.tsx`).
*   **Реальные API интеграции понадобятся для**: Авторизации (JWT), сохранения прогресса обучения, сохранения решений задач, лидерборда рейтинга и профиля.

---

## 6. СИСТЕМА ГЕЙМИФИКАЦИИ (GAMIFICATION SYSTEM)
Геймификация является ядром платформы, но сейчас полностью реализована в виде UI-декора:
*   **XP (Опыт) и Уровни**:
    Отображаются почти везде (Top Navbar в Арене, Дашборде, Профиле). Значения берутся в основном из начального состояния компонента как `useState(12450)` или `MOCK_USER.xp`.
*   **Streak (Серия в днях)**:
    Статичное отображение огонька (например, `5 Day Streak`).
*   **Достижения (Achievements)**:
    Отрисовываются карточками в `Profile.tsx` (Символы, Иконки, Награды), но их логика получения не реализована.
*   **Прогресс Модулей**:
    Анимация "разблокировки" и завершения уроков показана в `LearningMap.tsx`.
*   **Где живет**: Внутри каждого отдельного файла-страницы компонента "захардкожено".

---

## 7. СИСТЕМА СТИЛИЗАЦИИ (STYLING SYSTEM)
Проект настроен очень качественно с точки зрения стилей:
*   **Фреймворк**: Используется Tailwind CSS версии 3.4+.
*   **Цветовая палитра (В `tailwind.config.js`)**:
    *   Расширенные палитры `primary` (оттенок синего) и `indigo`.
    *   Градиентные цвета.
*   **Светлая / Темная тема**:
    *   Реализовано с помощью селектора `class` в настройках Tailwind (`darkMode: 'class'`).
    *   В `index.css` добавлены CSS-переменные корня (`:root` и `.dark`) для легкого переключения `bg-primary`, `text-primary`.
    *   Глобально используется класс Tailwind `dark:` повсеместно в компонентах: `bg-white dark:bg-[#1e293b]`.
*   **Типографика**: Подключен шрифт `'Inter'` (из Google Fonts), для кода `'Fira Code'`.

---

## 8. ИЗВЕСТНЫЕ ПРОБЛЕМЫ И ТЕХДОЛГ (KNOWN ISSUES & TECH DEBT)
*   **Отсутствие глобального State**: Это крупнейший долг. Пользователь не может "настоящим" образом залогиниться и переносить свой профиль из вкладки во вкладку.
*   **Моки выполнения кода**: Компонент `MockEditor.tsx` не собирает и не запускает JS-код, а просто использует `if (code.includes('return'))` и выдает fake setTimeout-вывод.
*   **Отсутствие защиты роутов**: Хотя роуты логически разделены на публичные/закрытые (`RouteLayout`), фактически компонент `<Route path="/dashboard">` доступен и без токена, перенаправления нет.
*   **Изолированные компоненты Уроков**: Дублирование логики между страницами `PythonLesson.tsx` и `LessonViewer.tsx` — оба являются по сути просмотрщиками уроков, но развивались как два разных компонента.

---

## 9. ЧЕГО НЕ ХВАТАЕТ (WHAT'S MISSING)
Основываясь на интерфейсе, но не найдено логики для:
*   **Бэкенд / База данных / Auth**: СУБД для хранения паролей, JWT токенов, историй решений и профилей. Не интегрировано с Firebase / Supabase или собственным REST/GraphQL API.
*   **Движок выполнения кода (Code Execution Engine)**: Настоящей "песочницы" (Sandbox/Docker/WebAssembly) для компиляции и проверки решений студента (Python/JS).
*   **AI Backend**: Мока для виджета `AIAssistant` — сейчас это просто заглушки ответов, не подключено API OpenAI / Anthropic.
*   **Многоязычность (i18n)**: Язык захардкожен на русский язык во всех компонентах, нет переключателя языка или `react-i18next`.

---

## 10. РЕКОМЕНДУЕМЫЕ ДАЛЬНЕЙШИЕ ШАГИ (RECOMMENDED NEXT STEPS)
*Приоритезированный список от быстрых побед к сложной архитектуре:*

*   [Высокий приоритет] **1. Глобальный стейт-менеджер (Zustand)**
    *   Создать хранилища: `useAuthStore` (для логина), `useUserStore` (XP, стрик, уровень) и `useProgressStore` (пройденные уроки). Связать с компонентами Дашборда и Арены для устранения "проп-дриллинга" и синхронизации стейта.
*   [Высокий приоритет] **2. Защита маршрутов (Route Guards)**
    *   Создать компонент `ProtectedRoute` в `App.tsx`, который будет проверять состояние авторизации и редиректить на `/login` гостей.
*   [Средний приоритет] **3. Унификация плеера контента**
    *   Объединить `LessonViewer.tsx` и `PythonLesson.tsx` в единый динамический компонент `LessonPlayer`, который сможет принимать данные по ID.
*   [Средний приоритет] **4. Подготовка к интеграции AI и Выполнению Кода**
    *   Сделать вызовы API для `AIAssistant` и `MockEditor` асинхронными функциями, в которые легко будет воткнуть реальные FETCH-запросы (например, к Judge0 для кода).
*   [Низкий приоритет, но Архитектурный] **5. Настройка реального API-слоя**
    *   Создать папку `/api/` или `/services/`, вынести туда `axios` конфиги, интерсепторы токенов. Перевести `MOCK_DATA` на функции загрузки `fetchCourses()`.
